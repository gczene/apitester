angular.module("apitester",["ngRoute","apitester.controllers","apitester.services"]).config(function($routeProvider){"use strict";$routeProvider.when("/new-project",{controller:"NewProjectCtrl",templateUrl:"/views/newProject.html"}).when("/project/:index",{controller:"ProjectCtrl",templateUrl:"/views/project.html"}).when("/edit-project/:index",{controller:"EditProjectCtrl",templateUrl:"/views/editProject.html"}).otherwise({redirectTo:"/project/0"})}),angular.module("apitester.services",[]),angular.module("apitester.controllers",["apitester.services"]),angular.module("apitester.services").service("projects",function(){"use strict";var demoProjects,projects,updateLocalStorage;demoProjects=[{name:"OpenWeatherMap",forms:[{url:"http://api.openweathermap.org/data/2.5/weather",method:"get",label:"Searching by city name",data:{},fields:[{name:"q",label:"city name"}]},{url:"http://api.openweathermap.org/data/2.5/weather",method:"get",label:"Seaching by geographic coordinats",data:{},fields:[{name:"lat",label:"latitude"},{name:"lon",label:"longitude"}]},{url:"http://api.openweathermap.org/data/2.5/weather",method:"get",label:"Seaching by city ID",data:{},fields:[{name:"id",label:"city ID"}]}]}],projects=angular.fromJson(localStorage.projects)||demoProjects,updateLocalStorage=function(){localStorage.projects=angular.toJson(projects)},this.list=function(){return projects},this.get=function(index){return projects[index]||!1},this.save=function(project,index){return index?projects[index]={name:project.name,forms:angular.fromJson(project.forms||"[]")}:index=projects.push({name:project.name,forms:angular.fromJson(project.forms||"[]")}),updateLocalStorage(),index},this.remove=function(index){index>0&&(projects.splice(index,1),updateLocalStorage())}}),angular.module("apitester.services").service("responses",["$http",function($http){"use strict";var updateLocalStorage,self=this;this.list=angular.fromJson(localStorage.responses)||[],updateLocalStorage=function(){localStorage.responses=angular.toJson(self.list)},this.remove=function(index){this.list.splice(index,1),updateLocalStorage()},this.sendRequest=function(options){"get"===options.method&&(options.params=options.data,delete options.data),$http(options).success(this.addSuccess).error(this.addError)},this.isLoading=function(){return $http.pendingRequests.length>0},this.addSuccess=function(data,status){self.list.unshift({status:status,data:data,error:!1}),updateLocalStorage()},this.addError=function(data,status){self.list.unshift({status:status,data:data,error:!0}),updateLocalStorage()}}]),angular.module("apitester.controllers").controller("ProjectListCtrl",["$scope","projects",function($scope,projects){"use strict";$scope.projects=projects.list()}]),angular.module("apitester.controllers").controller("NewProjectCtrl",["$scope","$location","projects",function($scope,$location,projects){"use strict";$scope.project={name:"",forms:""},$scope.back=function(){history.back()},$scope.save=function(){var index=projects.save($scope.project);$location.path("/project/"+index)}}]),angular.module("apitester.controllers").controller("EditProjectCtrl",["$scope","$routeParams","$filter","$location","projects",function($scope,$routeParams,$filter,$location,projects){"use strict";var index=$routeParams.index,project=projects.get(index);project||$location.path("/new-project"),$scope.index=index,$scope.title=project.name,$scope.project={name:project.name,forms:$filter("json")(project.forms)},$scope.back=function(){history.back()},$scope.save=function(){projects.save($scope.project,index),$location.path("/project/"+index)}}]),angular.module("apitester.controllers").controller("ProjectCtrl",["$scope","$routeParams","$location","projects",function($scope,$routeParams,$location,projects){"use strict";var index=$routeParams.index,project=projects.get(index);project||$location.path("/new-project"),$scope.index=index,$scope.title=project.name,$scope.project=project,$scope.remove=function(){projects.remove(index),$location.path("/project/0")}}]),angular.module("apitester.controllers").controller("FormCtrl",["$scope","responses",function($scope,responses){"use strict";$scope.sendRequest=function(){responses.sendRequest({url:$scope.form.url,method:$scope.form.method,data:$scope.form.data})}}]),angular.module("apitester.controllers").controller("ResponsesCtrl",["$scope","responses",function($scope,responses){"use strict";$scope.responses=responses.list,$scope.isLoading=function(){return responses.isLoading()},$scope.remove=function(index){responses.remove(index)}}]);