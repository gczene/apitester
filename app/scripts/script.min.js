angular.module("apitester",["ngRoute","apitester.controllers","apitester.services"]).config(function($routeProvider){"use strict";$routeProvider.when("/new-project",{controller:"NewProjectCtrl",templateUrl:"/views/newProject.html"}).when("/project/:index",{controller:"ProjectCtrl",templateUrl:"/views/project.html"}).when("/edit-project/:index",{controller:"EditProjectCtrl",templateUrl:"/views/editProject.html"}).otherwise({redirectTo:"/project/0"})}),angular.module("apitester.services",[]),angular.module("apitester.controllers",["apitester.services"]),angular.module("apitester.services").service("projects",function(){"use strict";var demoProjects,projects,restoreState,saveState;demoProjects=[{name:"OpenWeatherMap",forms:[{url:"http://api.openweathermap.org/data/2.5/weather",method:"get",label:"Searching by city name",fields:[{name:"q",label:"city name"}],data:{}},{url:"http://api.openweathermap.org/data/2.5/weather",method:"get",label:"Seaching by geographic coordinats",fields:[{name:"lat",label:"latitude"},{name:"lon",label:"longitude"}],data:{}},{url:"http://api.openweathermap.org/data/2.5/weather",method:"get",label:"Seaching by city ID",fields:[{name:"id",label:"city ID"}],data:{}}],responses:[]}],restoreState=function(){projects=angular.fromJson(localStorage.projects)||demoProjects},restoreState(),saveState=function(){localStorage.projects=angular.toJson(projects)},this.list=function(){return projects},this.get=function(index){return projects[index]||!1},this.save=function(project){var index=projects.indexOf(project);return-1!==index?projects[index]=project:index=projects.push(project)-1,saveState(),index},this.remove=function(project){var index=projects.indexOf(project);return index>0&&(projects.splice(index,1),saveState()),projects.length}}),angular.module("apitester.controllers").controller("ProjectListCtrl",["$scope","projects",function($scope,projects){"use strict";$scope.projects=projects.list()}]),angular.module("apitester.controllers").controller("NewProjectCtrl",["$scope","$location","projects",function($scope,$location,projects){"use strict";$scope.project={name:"",forms:[],responses:[]},$scope.formsJson="",$scope.save=function(){var index;$scope.project.forms=angular.fromJson($scope.formsJson||"[]"),index=projects.save($scope.project),$location.path("/project/"+index)}}]),angular.module("apitester.controllers").controller("EditProjectCtrl",["$scope","$routeParams","$filter","$location","projects",function($scope,$routeParams,$filter,$location,projects){"use strict";$scope.index=$routeParams.index,$scope.project=projects.get($scope.index),$scope.project||$location.path("/new-project"),$scope.formsJson=$filter("json")($scope.project.forms),$scope.save=function(){var index;$scope.project.forms=angular.fromJson($scope.formsJson||"[]"),index=projects.save($scope.project),$location.path("/project/"+index)}}]),angular.module("apitester.controllers").controller("ProjectCtrl",["$scope","$routeParams","$location","projects",function($scope,$routeParams,$location,projects){"use strict";$scope.index=$routeParams.index,$scope.project=projects.get($scope.index),$scope.project||$location.path("/new-project"),$scope.remove=function(){projects.remove($scope.project),$location.path("/")}}]),angular.module("apitester.controllers").controller("FormCtrl",["$scope","$http","projects",function($scope,$http,projects){"use strict";var onSuccess,onError;onSuccess=function(data,status){$scope.project.responses.unshift({data:data,status:status,error:!1}),projects.save($scope.project)},onError=function(data,status){$scope.project.responses.unshift({data:data,status:status,error:!0}),projects.save($scope.project)},$scope.submit=function(){var options;options="get"===$scope.form.method?{url:$scope.form.url,method:$scope.form.method,params:$scope.form.data}:{url:$scope.form.url,method:$scope.form.method,data:$scope.form.data},$http(options).success(onSuccess).error(onError)}}]),angular.module("apitester.controllers").controller("ResponsesCtrl",["$scope","$http","projects",function($scope,$http,projects){"use strict";$scope.isLoading=function(){return $http.pendingRequests.length>0},$scope.remove=function(index){$scope.project.responses.splice(index,1),projects.save($scope.project)}}]);